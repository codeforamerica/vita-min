<% @title = t(".title") %>
<% content_for :page_title, @title %>
<% content_for :card do %>
  <div class="slab slab--not-padded">
    <div class="grid">
      <div class="grid--item width-three-fourths">
        <div class="client-container">
          <%= form_with model: @form, url: [:hub, @client], method: :put, local: true, builder: VitaMinFormBuilder, html: { class: 'form-card' } do |f| %>
          <h1>
            <%= @title %>
          </h1>

          <%= render "primary_info_fields", f: f %>

          <%= error_message(@form, :dependents_attributes) %>
          <div id="dependent-info">
            <h3>Dependents:</h3>
            <%= f.fields_for :dependents do |ff| %>
              <%= render "dependent", f: ff %>
            <% end %>

            <%= link_to_add_fields t(".add_dependent"), f, :dependents, { class: "button button--small" }, partial: "hub/clients/dependent" %>
          </div>

          <%= render "spouse_info_fields", f: f %>

          <div class="hub-form__row">
            <button class="button button--cta" type="submit">
              <%=t("general.save") %>
            </button>

            <%= link_to t("general.cancel"), hub_client_path(id: @client.id), class: "button" %>
          </div>


          <div class="hub-form__row">
            <% if current_ability.can?(:destroy, @client) %>
              <%= link_to(
                      hub_client_path(id: @client.id),
                      method: :delete,
                      class: "button button--danger",
                      data: { confirm: t(".delete_confirmation", name: @client.legal_name) }
                  ) do %>
                <%= t(".delete_client") %>
              <% end %>
            <% end %>
          </div>

        <% end %>
        </div>
      </div>
    </div>
  </div>
<% end %>
